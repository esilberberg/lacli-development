<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-G8MVH2C5PD"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-G8MVH2C5PD');
    </script>

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="icon" type="image/x-icon" href="favicon/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png">
    <link rel="manifest" href="favicon/site.webmanifest">
    <link rel="mask-icon" href="favicon/safari-pinned-tab.svg" color="#19505c">
    <meta name="msapplication-TileColor" content="#19505c">
    <meta name="theme-color" content="#ffffff">

    <script src="https://kit.fontawesome.com/1d9765704f.js" crossorigin="anonymous"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=EB+Garamond:wght@400;500;700&family=Lato:ital,wght@0,300;0,400;1,300;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="library.css">

    <title>LACLI</title>
</head>
<body>
    <div class="overlay"></div>
    <header id="header-main"></header>
    <!-- <div id="message-box">
    <p id="message-content"></p>
    <div>
        <button id="message-ok-btn">OK</button>
    </div> -->
</div>
<div class="library-wrapper">
    <section class="search-interface">
        <div class="search-bar">
            <input type="text" id="library-search" placeholder="Enter keywords...">
            <button class="refresh-btn" id="x-btn"><i class="fa-solid fa-xmark"></i></button>
            <button id="library-search-btn"><i class="fa-solid fa-magnifying-glass"></i></button>
            <button id="search-help-btn" title="Search help"><i class="fa-regular fa-circle-question"></i></button>
        </div>
        <!-- Search Help Modal -->
        <div id="search-help" class="modal">

        <!-- Modal content -->
        <div class="modal-content">
            <span class="search-help-btn-close"><i class="fa-solid fa-xmark"></i></span>
            <div class="modal-heading">About LACLI Search</div>
            <ul>
                <li>Searches are not case sensitive and ignore diacritics.</li>
                <li>Truncation, wildcards, quotation marks, and lemmatization are not supported.</li>
                <li>It is preferable to search with singular rather than plural nouns.</li>
                <li>Search terms separated by a space are treated as independent search terms and are linked with the AND operator.</li>
                <li>All search terms must appear somewhere in the resource description fields for a resource to be returned in the results.</li>
                <li>If you select filters from the same filter category (e.g., Countries), the filters are joined by an OR operator. If you select filters from different filter categories (e.g., Formats & Countries), the filters are joined by an AND operator.</li>
                <li>There are two ways to save a search. First, copy the url. Only keywords, and not filters, are captured in the url. Second, download the records currently displayed as a JSON file via the Download button.</li>
            </ul>
        </div>

        </div>
        <div class="search-interface-utilities">
            <button class="refresh-btn"><span id="refresh-btn-text">New Search</span> &nbsp;<i class="fa-solid fa-arrow-rotate-right"></i></button>
            <button id="random-btn"><span id="random-btn-text">Random</span> &nbsp;<i class="fa-solid fa-bolt"></i></button>
            <button id="filters-btn"><span id="filters-btn-text">Filters</span> &nbsp;<i class="fa-solid fa-sliders"></i></button>

        </div>
    </section>
          <div class="search-summary">
            <div id="displaySearchSummary"></div>
            <div id="activeFacetsSummary"></div>
        </div>
    <div class="library-content">
        <section class="facets"></section>
        <section class="search-results">
            <button id="export-btn"><span id="export-btn-text">Download</span> &nbsp;<i class="fa-solid fa-download"></i></button>
            <div class="lacli-resources-display">
                
                <div id="display">
                    <div id="loader">
                        <div class="loader"></div>
                    </div>
                </div>
                <button id="loadMore">Load More <i class="fa-solid fa-chevron-down"></i></button>
            </div>
        <button id="topButton" class="top-button"><i class="fa-regular fa-circle-up"></i></button> 
        </section>
    </div>
</div>
<script>
        // Define the data for each facet section
        const facetsData = [
            { header: 'Resource Types', id: 'resource-types-facet', lacliField: 'Resource_Types' },
            { header: 'Formats', id: 'specific-formats-facet', lacliField: 'Specific_Formats' },
            { header: 'Countries', id: 'countries-facet', lacliField: 'Countries' },
            { header: 'Broad Subjects', id: 'broad-subject-areas-facet', lacliField: 'Broad_Subject_Areas' },
            { header: 'Subjects in English', id: 'subjects-in-english-facet', lacliField: 'Subjects_in_English' },
            { header: 'Materias en Espa√±ol', id: 'materias-en-espanol-facet', lacliField: 'Materias_en_Espanol' },
            { header: 'Assuntos em Portugues', id: 'assuntos-em-portugues-facet', lacliField: 'Assuntos_em_Portugues' },
            { header: 'Languages', id: 'languages-facet', lacliField: 'Languages' },
            { header: 'Geographical Area', id: 'geographical-area-facet', lacliField: 'Geographical_Area' },
            { header: 'Time Coverage', id: 'time-coverage-facet', lacliField: 'Time_Coverage' },
            { header: 'Institutional Host', id: 'institutional-hosts-facet', lacliField: 'Institutional_Hosts' }
        ];

        // Start building the HTML string for the facets content (without the outer section tags)
        let facetsContentHtml = '<div id="facets-mobile-panel-heading"><button id="close-facets-btn"><i class="fa-solid fa-xmark"></i></button></div>';

        // Loop through the facet data to create HTML for each facet block
        facetsData.forEach(facet => {
            // Accessing the property using bracket notation since the key has a hyphen
            facetsContentHtml += `
                <div>
                    <p class="facet-accordion-header">${facet.header} <span class="accordion-icon">+</span></p>
                    <div id="${facet.id}" class="facet-accordion-content">
                        <div class="sort-buttons" data-facet-field="${facet.lacliField}">
                            <button class="sort-btn" data-sort-type="alphabetical">A-Z</button>
                            <button class="sort-btn" data-sort-type="count">1-9</button>
                        <div class="facet-list-scroll-container"></div>
                    </div>
                        
                        <p>Loading...</p>
                    </div>
                </div>
            `;
        });

        // Get the existing section with class "facets"
        const existingFacetsSection = document.querySelector('.facets');

        // Check if the section exists before injecting HTML
        if (existingFacetsSection) {
            existingFacetsSection.innerHTML = facetsContentHtml;
        } else {
            console.error('Error: No existing <section class="facets"> found to inject content into.');
        }
    </script>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const facetAccordionHeaders = document.querySelectorAll('.facet-accordion-header');
        facetAccordionHeaders.forEach(header => {
            header.addEventListener('click', () => {
                const content = header.nextElementSibling;
                // Toggle the 'active' class on the header 
                header.classList.toggle('active'); 
                content.classList.toggle('active');
            });
        });  
    });
</script> 
<script>
var modal = document.getElementById("search-help");

var searchHelpBtn = document.getElementById("search-help-btn");

var span = document.getElementsByClassName("search-help-btn-close")[0];

// When the user clicks the button, open the modal 
searchHelpBtn.onclick = function() {
  modal.style.display = "block";
}

// When the user clicks on <span> (x), close the modal
span.onclick = function() {
  modal.style.display = "none";
}

// When the user clicks anywhere outside of the modal, close it
window.onclick = function(event) {
  if (event.target == modal) {
    modal.style.display = "none";
  }
}
</script>
<script>
// Filters Mobile Panel
const closeFacetsBtn = document.querySelector("#close-facets-btn");
const openFacetsBtn = document.querySelector("#filters-btn");
const facets = document.querySelector(".facets");
const overlay = document.querySelector(".overlay"); 

// Event listener to open the facets panel and show the overlay
openFacetsBtn.addEventListener("click", () => {
  if (facets) {
    facets.style.display = "inline";
  }
  if (overlay) {
    overlay.classList.add('visible');
  }
});

// Event listener to close the facets panel and hide the overlay
closeFacetsBtn.addEventListener("click", () => {
  if (facets) {
    facets.style.display = "none";
  }
  if (overlay) {
    overlay.classList.remove('visible');
  }
});

// Event listener for screen resizing
window.addEventListener('resize', () => {
  if (window.innerWidth > 800) {
    if (facets) {
      facets.style.display = ''; // This removes the inline style and lets CSS take over
    }
    if (overlay) {
      overlay.classList.remove('visible');
    }
  } else {
    if (facets && facets.style.display === "none") {
      if (overlay) {
        overlay.classList.remove('visible');
      }
    }
  }
});

// Optional: Add a click listener to the overlay to close the facets panel
if (overlay) {
  overlay.addEventListener('click', () => {
    if (facets) {
      facets.style.display = "none";
    }
    if (overlay) {
      overlay.classList.remove('visible');
    }
  });
}
</script>

    </main>
    <footer class="footer-secondary">
        <p>LACLI, 2025</p>
        <p>Latin American, Caribbean, Latinx, and Iberian Free Online Resources</p>
    </footer>
<script src="header.js"></script>
<script src="scripts/app2.js"></script>
<!-- <script src="scripts/app.js"></script> -->
<script src="scripts/navigation.js"></script>
<script src="translation/libraryNavbar.js"></script>
<script src="translation/library.js"></script>

</body>
